<!DOCTYPE html>
<html lang="en" class="scroll-p-16 snap-y snap-mandatory">
  <head>
    <%- include('./partials/head'); %>
  </head>
  <body class="font-sans text-stone-900 bg-gray-100">
    <%- include('./partials/navbar'); %>
    <div
      class="flex text-center justify-center items-center overflow-hidden relative w-full h-full-with-nav snap-start"
    >
      <div class="w-full h-full p-4">
        <div class="bg-white w-full h-full drop-shadow-sm border-2 border-stone-600 p-4 overflow-y-auto" id="todo">
          <div class="text-left mb-4"><p class="text-2xl">To do</p></div>
          <!-- Doing task -->
    <% order.forEach((item) => { %>
        <% if (item.status === "Todo") { %>
          <div
            class="min-h-16 p-2 flex flex-col justify-center border-2 border-stone-600 mb-4"
            draggable="true"
            id="<%= item.order_id %>"
          >
            <hr
              class="border-2 border-stone-600 rounded-lg w-2/5 self-center"
            />
            <div class="text-left mb-4">#<%= item.order_id %></div>
            <div class="ml-2 mr-2">
              <% if (item.order_list.length > 1) { %>
                <div class="text-left">Orders</div>
              <% } else { %>
                <div class="text-left">Order</div>
              <% } %>
              <hr class="border-0 border-b-2 border-stone-600" />
              <div class="flex justify-between">
                <div class="m-4 text-left">
                  <% item.order_list.forEach((menu, index) => { %>
                    <p><%= index + 1 %>. <%= menu.menu_name %></p>
                  <% }); %>
                </div>
                <div class="m-4 text-right">
                  <% item.order_list.forEach((menu) => { %>
                    <p>x <%= menu.quantity %></p> 
                  <% }); %> 
                </div> 
              </div> 
            </div> 
          </div> 
        <% } %> 
      <% }); %> 
    </div> 
  </div> 

      <div class="w-full h-full p-4">
        <div class="bg-white w-full h-full drop-shadow-sm border-2 border-stone-600 p-4 overflow-y-auto" id="doing">
          <div class="text-left mb-4"><p class="text-2xl">Doing</p></div>
          <!-- Doing task -->
          <% order.forEach((item) => { %> <% if (item.status === "Doing") { %>
          <div
            class="min-h-16 p-2 flex flex-col justify-center border-2 border-stone-600 mb-4 overflow-y-auto"
            draggable="true"
            id="<%= item.order_id %>"
          >
            <hr
              class="border-2 border-stone-600 rounded-lg w-2/5 self-center"
            />
            <div class="text-left mb-4">#<%= item.order_id %></div>
            <div class="ml-2 mr-2">
              <% if (item.order_list.length > 1) { %>
              <div class="text-left">Orders</div>
              <% } else { %>
              <div class="text-left">Order</div>
              <% } %>
              <hr class="border-0 border-b-2 border-stone-600" />
              <div class="flex justify-between">
                <div class="m-4 text-left">
                  <% item.order_list.forEach((menu, index) => { %>
                  <p><%= index + 1 %>. <%= menu.menu_name %></p>
                  <% }); %>
                </div>
                <div class="m-4 text-right">
                  <% item.order_list.forEach((menu) => { %>
                  <p>x <%= menu.quantity %></p>
                  <% }); %>
                </div>
              </div>
            </div>
          </div>
          <% } %> <% }); %>
        </div>
      </div>

      <div class="w-full h-full p-4">
        <div class="bg-white w-full h-full drop-shadow-sm border-2 border-stone-600 p-4 overflow-y-auto" id="done">
          <div class="text-left mb-4"><p class="text-2xl">Done</p></div>
        <!-- Doing task -->
    <% order.forEach((item) => { %>
        <% if (item.status === "Done") { %>
          <div
            class="min-h-16 p-2 flex flex-col justify-center border-2 border-stone-600 mb-4"
            draggable="true"
            id="<%= item.order_id %>"
          >
            <hr
              class="border-2 border-stone-600 rounded-lg w-2/5 self-center"
            />
            <div class="text-left mb-4">#<%= item.order_id %></div>
            <div class="ml-2 mr-2">
              <% if (item.order_list.length > 1) { %>
                <div class="text-left">Orders</div>
              <% } else { %>
                <div class="text-left">Order</div>
              <% } %>
              <hr class="border-0 border-b-2 border-stone-600" />
              <div class="flex justify-between">
                <div class="m-4 text-left">
                  <% item.order_list.forEach((menu, index) => { %>
                    <p><%= index + 1 %>. <%= menu.menu_name %></p>
                  <% }); %>
                </div>
                <div class="m-4 text-right">
                  <% item.order_list.forEach((menu) => { %>
                    <p>x <%= menu.quantity %></p> 
                  <% }); %> 
                </div> 
              </div> 
            </div> 
          </div> 
        <% } %> 
      <% }); %> 
    </div> 
  </div> 

    <script>
      const draggableElements = document.querySelectorAll('[draggable="true"]');
      const dropZones = document.querySelectorAll("#todo, #doing, #done");

      draggableElements.forEach((element) => {
        element.addEventListener("dragstart", (event) => {
          event.dataTransfer.setData("text/plain", event.target.id);
        });
      });

      dropZones.forEach((zone) => {
        zone.addEventListener("dragover", (event) => {
          event.preventDefault();
        });

        zone.addEventListener("dragenter", (event) => {
          event.preventDefault();
        });

        zone.addEventListener("drop", (event) => {
          event.preventDefault();
          const data = event.dataTransfer.getData("text/plain");
          const draggedElement = document.getElementById(data);
          zone.appendChild(draggedElement);
        });
      });
    </script>
  </body>
</html>
